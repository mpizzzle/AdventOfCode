#!/usr/bin/env BQN

input â† â€¢FLines "files/7.txt"

functions â† âŸ¨
  "B â† 2 {âŒ½ğ•—|âŒŠâˆ˜Ã·âŸœğ•—âŸ(â†•1+Â·âŒŠğ•—â‹†â¼1âŒˆâŠ¢)} âŠ¢", # int to binary array
  "N â† 2âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½âŠ¢", # binary array to int
  "P â† 16-âŠ¸â†‘âŠ¢", # pad to 16 bits
  "AND â† Nâˆ§â—‹(Pâˆ˜B)",
  "OR â† Nâˆ¨â—‹(Pâˆ˜B)",
  "NOT â† NÂ¬âˆ˜Pâˆ˜B",
  "LSHIFT â† Nâ¥ŠâŸœ0âŠ¸Â«âŸœ(Pâˆ˜B)Ëœ",
  "RSHIFT â† Nâ¥ŠâŸœ0âŠ¸Â»âŸœ(Pâˆ˜B)Ëœ"
âŸ©

Partition â† (4<Ëœ(â†•âˆ˜4+(âŠâˆ˜/" -> "â·âŠ¢))âŠ’â†•âˆ˜â‰ ) (âŠ¢-Ëœ+`Ã—Â¬)âŠ¸âŠ”âŠ¢
Format â† âˆ¾Â¯1âŠ¸â†‘âˆ¾'â†'âˆ¾1âŠ¸â†‘
Execute â† {
  repl â† â€¢ReBQN {repl â‡ "loose"}
  REPL Â¨ functions
  ((REPLâŠâŠ¢)Â¨âŠ¢) âŸ 111 Formatâˆ˜Partition Â¨ ğ•©
  â€¢Show REPL "a"
}

a â† Execute input # part 1
Execute (" -> b" âˆ¾Ëœ â€¢Fmt a) âŒ¾ (3âŠ¸âŠ‘) input # part 2
