#!/usr/bin/env BQN

input â† â€¢FLines "files/7.txt"

Partition â† (4<Ëœ(â†•âˆ˜4+(âŠâˆ˜/" -> "âŠ¸â·))âŠ’â†•âˆ˜â‰ ) (âŠ¢-Ëœ+`Ã—Â¬)âŠ¸âŠ”âŠ¢
Format â† âˆ¾Â¯1âŠ¸â†‘âˆ¾'â†'âˆ¾1âŠ¸â†‘
Define â† {âŸ¨"", "", 1âŠ‘Â¨ğ•©âŸ© ğ• "â†â€¢args" âˆ¾Ëœ 1â†“ âˆ¾'â€¿'âˆ¾Â¨ 0âŠ‘Â¨ğ•© }

B â† 2 {âŒ½ğ•—|âŒŠâˆ˜Ã·âŸœğ•—âŸ(â†•1+Â·âŒŠğ•—â‹†â¼1âŒˆâŠ¢)} âŠ¢ # int to binary array
N â† 2âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½âŠ¢ # binary array to int
P â† (16-âŠ¸â†‘âŠ¢)âˆ˜B # pad to 16 bits

Execute â† {
  repl â† â€¢ReBQN {repl â‡ "loose"}
  repl Define âŸ¨ "and"â€¿(Nâˆ§â—‹P), "or"â€¿(Nâˆ¨â—‹P), "lshift"â€¿(Nâ¥ŠâŸœ0âŠ¸Â«âŸœPËœ), "rshift"â€¿(Nâ¥ŠâŸœ0âŠ¸Â»âŸœPËœ), "not"â€¿Â¬ âŸ©
  REPLâŠâŠ¢Â¨ âŸ 111 Formatâˆ˜Partition Â¨ ğ•©
  REPL "a"
}

â€¢Show a â† Execute input # part 1
â€¢Show Execute (" -> b" âˆ¾Ëœ â€¢Fmt a) âŒ¾ (3âŠ¸âŠ‘) input # part 2
