#!/usr/bin/env BQN

input â† â€¢FLines "files/23.txt"

S â† "â‹„1" âˆ¾Ëœ (âˆ¾(1âŠ¸âŠ‘) âˆ¾ " â†© " âŒ¾ (0âŠ¸âŠ‘)âˆ¾âŠ£)
J â† âˆ¾ ')' âˆ¾Ëœ âŠ£ { ğ•¨ âŒ¾(1âŠ¸âŠ‘) ğ•© } âŠ¢âŸœ(âŒ½âŒ¾(2âŠ¸â†‘))

eâ€¿o â† "((1Ã—1âŠ¸âŠ£=2|âŠ¢)+(âŠ£Ã—0âŠ¸âŠ£=2|âŠ¢))Ëœ("â€¿"((1Ã—1â‰ âŠ¢)+(âŠ£Ã—1=âŠ¢))Ëœ("
labels â† "hlf"â€¿"tpl"â€¿"inc"â€¿"jmp"â€¿"jie"â€¿"jio"
instructions â† ("Ã·2"âŠ¸S)â€¿("Ã—3"âŠ¸S)â€¿("+1"âŠ¸S)â€¿(1âŠ‘âŠ¢)â€¿(eâŠ¸J)â€¿(oâŠ¸J)

Partition â† ' '((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢)âŠ¢/Ëœ','â‰ âŠ¢
GetInstruction â† (/labelsâˆŠâŠ¢) â—¶ instructions

program â† GetInstructionâˆ˜Partition Â¨ input

Execute â† {
  repl â† â€¢ReBQN {repl â‡ "strict"}
  REPL Â¨ ğ•¨
  ((REPLâˆ˜(program âŠ‘Ëœ âŠ¢)+âŠ¢) âŸ ğ•©) 0
  â€¢Show REPL "b"
}

"bâ†0"â€¿"aâ†0" Execute 1484 # part 1
"bâ†0"â€¿"aâ†1" Execute 1936 # part 2
