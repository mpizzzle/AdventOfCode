test ← ⊂⍎¨10 10⍴'5483143223274585471152645561736141336146635738547841675246452176841721688288113448468485545283751526'
input ← ⊂⍎¨10 10⍴'1443582148655373485114517412468835218864166231726217316566231128178367584235166566773268437381433267'

b ← 9>⍨⊢
Dumbo ← {
    f ← (1 + ⊃⍵) + (((+/+⌿⍤⊢) ⌺ 3 3) ⊢)⍤b⍤⊢
    (⊂ (⊢×~⍤b⍤⊢) f ⍣ (⊢(100 = +/⍤(+⌿=⍥b)) f) 1 + ⊃⍵) , ⍺⍺ ⍵
}

+/+⌿ ⊃ +⌿ 0 = ((⊢ Dumbo) ⍣ 100) input ⍝ part 1
1 -⍨ 1 ↓ ((1+1↓⊢) Dumbo) ⍣ (0=(+/+⌿⍤⊃⍤⊢)) (⊃ input) 0 ⍝ part 2
