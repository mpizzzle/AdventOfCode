#! /usr/bin/env BQN

Nat â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0'

# Parse natural number from string (zero on empty)
ToNat â‡ Nat'0'âŠ¸âˆ¾

# Parse integer from string
ToInt â‡ ('-'=âŠ‘)âŠ¸(Natâˆ˜â†“ Ã— 1-Ëœ2Ã—Â¬âˆ˜âŠ£)

# Cut âŠ¢ at 0s in âŠ£, giving a slice for each group of 1s
Part â‡ (Â¬-ËœâŠ¢Ã—Â·+`Â»âŠ¸>)âŠ¸âŠ”

# Remove trailing and duplicate blanks
Trim â‡ (âˆ¨âŸœÂ«' 'âŠ¸â‰ )âŠ¸/

# Return boolean array where 1s are digits 0-9 in âŠ¢
Digits â‡ âˆŠâŸœ('0'+â†•10)

# Split âŠ¢ at occurrences of separators âŠ£, removing the separators
Split â‡ (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢

# Split âŠ¢ into groups of length âŠ£, plus a shorter one at the end if needed
Group â‡ âŒŠâˆ˜Ã·ËœâŸœ(â†•â‰ )âŠ”âŠ¢

# Least Common Muliple of natural numbers âŠ£ and âŠ¢
LCM â‡ (Ã—Ã·{ğ•¨(|ğ•ŠâŸ(>âŸœ0)âŠ£)ğ•©})

# Apply ğ”½ to âŠ¢ repeatedly until ğ”¾ returns 0 (avoiding stack overflow)
_while_ â‡ {ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}
