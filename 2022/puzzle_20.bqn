#!/usr/bin/env BQN

⟨Part, ToInt⟩ ← •Import "idioms.bqn"

input ← ToInt¨ •FLines "files/20.txt"

D ← { 
  a ← 𝕩 ((1-˜≠∘⊢) | /∘⍷ + 1⊑⊑∘⊣) 𝕨
  (0 = a) ⌽ 𝕩 (a⊸↑∾⊣∾a⊸↓) 𝕩 (∾ ¬∘⍷ Part ⊢) 𝕨
}

B ← ⊣ D ⊑¨⊸(/=) ⊏ ⊣
Grove ← ⊢ ⊑˜ ≠∘⊢ | |˜⟜≠ + (/0⊸=)

ss ← 1⊸⊑¨ (⊢ B˜´ ⌽∘↕∘≠) <˘⍉> ↕∘≠⊸⋈ input

(1000⊸Grove + 2000⊸Grove + 3000⊸Grove) ss
