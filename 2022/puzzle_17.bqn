#!/usr/bin/env BQN

âŸ¨_while_, LCMâŸ© â† â€¢Import "idioms.bqn"

input â† (Â¯1âŠ¸Ã—+Â¬)'>'âŠ¸= âŠ‘ â€¢FLines "files/17.txt"
#input â† (Â¯1âŠ¸Ã—+Â¬)'>'âŠ¸= ">>><<><>><<<>><>>><<<>>><<<><<<>><>><<>>"

a â† â‰"####"
b â† >".#."â€¿"###"â€¿".#."
c â† >"..#"â€¿"..#"â€¿"###"
d â† â‰â‰"####"
e â† >"##"â€¿"##"

forms â† (Â¯2âŒ½7âŠ¸â†‘)Ë˜Â¨ '#'âŠ¸= aâ€¿bâ€¿câ€¿dâ€¿e
state â† 0 â‹ˆ (Â¯4â†‘â‰7/â‰1) â‹ˆ 0 â‹ˆâ—‹â‰ 0

Apply â† { ğ•¨âŠ¸{ ğ•© âˆ¨ 1 âŠ‘ ğ•¨ } âŒ¾ (({ (1-Ëœ âŠ‘ âŒ½ âŠ‘ ğ•©) + â†• âŠ‘ â‰¢ 1 âŠ‘ ğ•© } ğ•¨)âŠ¸âŠ) ğ•© }
Pad â† âŠ¢â†‘ËœÂ¯1Ã—âŠ£+âŠ‘âˆ˜â‰¢âˆ˜âŠ¢
Push â† (âŠ‘âŠ£Ã—Â¬âˆ˜(âˆ¨Ëâ†‘Ë˜))âŒ½Ë˜âŠ¢

F â†  { ğ•© PushËœ input âŠ‘Ëœ âŠ‘ğ•¨ }
W â†  { ğ•© â‹ˆËœ ğ•¨ |Ëœ â‰ input }â—‹(1âŠ¸+)

Lol â† { (1âŠ‘ğ•¨) + â†•âŠ‘â‰¢ğ•© }Â´
Overlap â† { âˆ¨Â´âˆ¨Ë (1 âŠ‘ ğ•©) âˆ§ ğ•¨ âŠËœ Lol ğ•© }Â´

Jet â† { (ğ•¨â‹ˆğ•©) { ğ•©â€¿((1âŠ‘1âŠ‘ğ•¨) â‹ˆËœ âŠ‘ğ•©) âŠ‘Ëœ Overlap (0âŠ‘ğ•¨) â‹ˆ ((âŠ‘1âŠ‘ğ•¨) â‹ˆ 1âŠ‘ğ•©) }  { (ğ•¨ F ğ•©) â‹ˆËœ WÂ´ ğ•¨ }Â´ ğ•© }

Do â† (âŠ£ â‹ˆ Jet)Â´

Cut â† { { (100âŒŠâŠ‘â‰¢ğ•©) â†‘ ğ•©} { ğ•© â†‘Ëœ Â¯1Ã—3+âŠ‘â‰¢ğ•© } ğ•© âŠËœ / âˆ¨Â´Ë˜ ğ•©}
Format â† âŠ‘âˆ˜â‰¢âŠ¸PadâŸœ(Cut ApplyËœÂ´) â‹ˆ âŠ£ â‹ˆËœ (âŠ‘âˆ˜âŠ‘1âŠ‘âŠ¢) â‹ˆ 0Ë™
Choose â† (â‰ âˆ˜âŠ¢|âŠ£)âŠ‘âŠ¢
Loop â† { (ğ•¨ + 1) â‹ˆ Do _while_ (Â¬Overlap) ğ•© FormatËœ ğ•¨ Choose forms }Â´

â€¢Show 4 -Ëœ âŠ‘ â‰¢ Cut ApplyËœÂ´ 1 âŠ‘ LoopâŸ2022 state # part 1
