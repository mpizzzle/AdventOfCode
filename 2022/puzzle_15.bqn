#!/usr/bin/env BQN

âŸ¨Split, ToInt, Group, _while_âŸ© â† â€¢Import "idioms.bqn"

Parse â† { 2 Group ToIntÂ¨ (Â¯1âŠ¸â†‘âˆ¾ËœÂ¯1â†“Â¨3âŠ¸â†‘) 2 â†“Â¨ 2â€¿3â€¿8â€¿9 âŠ ' 'âŠ¸Split ğ•© }Â¨

input â† Parse â€¢FLines "files/15.txt"

C â† {(ğ•¨â‰¤1) âˆ§ (ğ•©â‰¥Â¯1)}

Take â† { ((âŠ‘ğ•¨)âŒŠâŠ‘ğ•©)â‹ˆ((âŠ‘âŒ½ğ•¨)âŒˆâŠ‘âŒ½ğ•©) }

G â† { (ğ•©â‹ˆğ•¨Takeğ•©) âŠ‘Ëœ CÂ´ ğ•¨-âŒ½ğ•© }
F â† { GÂ´ ğ•© âŒ½âŒ½ ğ•¨ }
S â† {â· ğ•©âŠ¸FÂ¨ â†•â‰ ğ•©}

R â† { ((âŠ¢+ğ•¨-âŠ¢) âŒ¾ (1âŠ¸âŠ‘))Â¨ âŠ‘Â¨ ğ•© }
Q â† { (âŠ‘Â¨ ğ•¨ âŠËœ / ğ•© â‰¥ 0) (-â‹ˆ+)Â¨ (ğ•© âŠËœ / ğ•© â‰¥ 0) }
K â† { ((+Â´|âˆ˜-)Â´Â¨ ğ•©) - | (ğ•¨-1âŠ¸âŠ‘)Â¨ âŠ‘Â¨ ğ•© }

Row â† (+Â´(1+-Ëœ)Â´Â¨)âˆ˜(SâŸ2 R Q K) - (+Â´âŠ£=1âŠ‘Â¨(â·1âŠ¸âŠ‘Â¨))
Scan â† (((1âŠ¸+)âŠ¸â‹ˆâ‹ˆ((SâŸ2 ((0âŒˆâŠ£)âˆ¾4000000âŒŠâŠ¢)Â´Â¨) R Q K))Â´âŠ¢)Â´

â€¢Show 2000000 Row input # part 1
â€¢Show ((1-Ëœ(âŠ‘1âŠ¸âŠ‘)) + 4000000 Ã— 1 + (1âŠ¸âŠ‘âŠ‘âˆ˜âŠ‘)) Scan _while_ (1=â‰ âˆ˜âŠ‘) âŸ¨âŸ¨âŸ©âŸ© â‹ˆ (0 â‹ˆ input) # part 2
