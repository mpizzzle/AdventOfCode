#!/usr/bin/env BQN

âŸ¨Split, ToInt, Group, PartâŸ© â† â€¢Import "idioms.bqn"

input â† { 2 Group ToIntÂ¨ (Â¯1âŠ¸â†‘âˆ¾ËœÂ¯1â†“Â¨3âŠ¸â†‘) 2 â†“Â¨ 2â€¿3â€¿8â€¿9 âŠ ' 'âŠ¸Split ğ•© }Â¨ â€¢FLines "files/test.txt"
input2 â† { 2 Group ToIntÂ¨ (Â¯1âŠ¸â†‘âˆ¾ËœÂ¯1â†“Â¨3âŠ¸â†‘) 2 â†“Â¨ 2â€¿3â€¿8â€¿9 âŠ ' 'âŠ¸Split ğ•© }Â¨ â€¢FLines "files/15.txt"

manhattans â† (+Â´|âˆ˜-)Â´Â¨ input2
level â† 2000000

ps â† ((âŠ¢+level-âŠ¢) âŒ¾ (1âŠ¸âŠ‘))Â¨ âŠ‘Â¨ input2
d â† manhattans - | (level-1âŠ¸âŠ‘)Â¨ âŠ‘Â¨ input2
dt â† d âŠËœ / d â‰¥ 0
st â† âŠ‘Â¨ ps âŠËœ / d â‰¥ 0

ranges â† st (-â‹ˆ+)Â¨ dt

C â† {(ğ•¨â‰¤0) âˆ§ (ğ•©â‰¥0)}
G â† { ğ•¨â€¿(((âŠ‘ğ•¨)âŒŠâŠ‘ğ•©)â‹ˆ((âŠ‘âŒ½ğ•¨)âŒˆâŠ‘âŒ½ğ•©)) âŠ‘Ëœ CÂ´ ğ•¨-âŒ½ğ•© }
F â† { GÂ´ ğ•© âŒ½ ğ•¨ }

next â† (âŒ½ranges)âŠ¸FÂ¨ â†•â‰ ranges
n1 â† â· (âŒ½next)âŠ¸FÂ¨ â†•â‰ next

bc â† +Â´ level = 1 âŠ‘Â¨ â· 1 âŠ‘Â¨ input2

â€¢Show bc -Ëœ +Â´(1+-Ëœ)Â´Â¨ n1 # part 1
